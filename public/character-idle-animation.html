<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ï∫êÎ¶≠ÌÑ∞ Idle Animation - Canvas 2D</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            font-family: 'Segoe UI', sans-serif;
        }

        .container {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 20px;
            font-size: 24px;
        }

        canvas {
            display: block;
            background: #f8f9fa;
            border-radius: 12px;
            box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .info {
            margin-top: 20px;
            padding: 15px;
            background: #f0f0f0;
            border-radius: 8px;
            font-size: 14px;
            color: #666;
            text-align: center;
        }

        .fps {
            font-weight: bold;
            color: #667eea;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üé≠ Ï∫êÎ¶≠ÌÑ∞ Idle Animation</h1>
        <canvas id="characterCanvas" width="400" height="400"></canvas>
        <div class="info">
            FPS: <span class="fps">8</span> | Delta Time Í∏∞Î∞ò Ïï†ÎãàÎ©îÏù¥ÏÖò
        </div>
    </div>

    <script>
        /**
         * ========================================
         * Ï∫êÎ¶≠ÌÑ∞ Idle Animation ÏãúÏä§ÌÖú
         * ========================================
         * - requestAnimationFrameÏúºÎ°ú Î∂ÄÎìúÎü¨Ïö¥ Î†åÎçîÎßÅ
         * - Delta TimeÏúºÎ°ú 8fps ÌîÑÎ†àÏûÑ Ï†ÑÌôò Ï†úÏñ¥
         * - Ï†úÏûêÎ¶¨ÏóêÏÑú ÏõÄÏßÅÏù¥Îäî idle Î™®ÏÖò
         */

        // ==================== ÏÑ§Ï†ï ====================
        const CONFIG = {
            canvas: {
                width: 400,
                height: 400,
                centerX: 200,
                centerY: 200
            },
            animation: {
                targetFPS: 8,                      // Î™©Ìëú ÌîÑÎ†àÏûÑ ÏÜçÎèÑ
                frameDuration: 1000 / 8,           // ÌîÑÎ†àÏûÑ Îãπ ÏãúÍ∞Ñ (125ms)
                totalFrames: 8                     // Ï¥ù ÌîÑÎ†àÏûÑ Ïàò
            },
            character: {
                baseRadius: 80,                    // Í∏∞Î≥∏ Î∞òÏßÄÎ¶Ñ
                color: '#FFD700',                  // Ï∫êÎ¶≠ÌÑ∞ ÏÉâÏÉÅ
                strokeColor: '#FFA500',            // Ïô∏Í≥ΩÏÑ† ÏÉâÏÉÅ
                eyeColor: '#000000'                // Îàà ÏÉâÏÉÅ
            }
        };

        // ==================== Canvas Ï¥àÍ∏∞Ìôî ====================
        const canvas = document.getElementById('characterCanvas');
        const ctx = canvas.getContext('2d');

        // ==================== Ïï†ÎãàÎ©îÏù¥ÏÖò ÏÉÅÌÉú ====================
        let lastFrameTime = 0;                     // ÎßàÏßÄÎßâ ÌîÑÎ†àÏûÑ ÏãúÍ∞Ñ
        let accumulatedTime = 0;                   // ÎàÑÏ†Å ÏãúÍ∞Ñ
        let currentFrame = 0;                      // ÌòÑÏû¨ ÌîÑÎ†àÏûÑ Ïù∏Îç±Ïä§
        let animationId = null;                    // Ïï†ÎãàÎ©îÏù¥ÏÖò ID

        /**
         * ==================== ÌîÑÎ†àÏûÑÎ≥Ñ Ïï†ÎãàÎ©îÏù¥ÏÖò Îç∞Ïù¥ÌÑ∞ ====================
         * Í∞Å ÌîÑÎ†àÏûÑÎßàÎã§ Ï∫êÎ¶≠ÌÑ∞Ïùò Î≥ÄÌôîÎ•º Ï†ïÏùò
         * - scaleY: YÏ∂ï ÌÅ¨Í∏∞ Î≥ÄÌôî (Ïà®Ïâ¨Îäî Ìö®Í≥º)
         * - offsetY: YÏ∂ï ÏúÑÏπò Î≥ÄÌôî (Îë•Ïã§Îë•Ïã§)
         * - squish: Ï∞åÍ∑∏Îü¨Ïßê Ï†ïÎèÑ
         */
        const ANIMATION_FRAMES = [
            { scaleY: 1.00, offsetY: 0,   squish: 1.00 },   // ÌîÑÎ†àÏûÑ 0
            { scaleY: 1.02, offsetY: -2,  squish: 0.98 },   // ÌîÑÎ†àÏûÑ 1
            { scaleY: 1.05, offsetY: -4,  squish: 0.95 },   // ÌîÑÎ†àÏûÑ 2
            { scaleY: 1.03, offsetY: -3,  squish: 0.97 },   // ÌîÑÎ†àÏûÑ 3
            { scaleY: 1.00, offsetY: 0,   squish: 1.00 },   // ÌîÑÎ†àÏûÑ 4
            { scaleY: 0.98, offsetY: 2,   squish: 1.02 },   // ÌîÑÎ†àÏûÑ 5
            { scaleY: 0.95, offsetY: 4,   squish: 1.05 },   // ÌîÑÎ†àÏûÑ 6
            { scaleY: 0.97, offsetY: 3,   squish: 1.03 }    // ÌîÑÎ†àÏûÑ 7
        ];

        /**
         * ==================== Ï∫îÎ≤ÑÏä§ Ï¥àÍ∏∞Ìôî ====================
         * Îß§ ÌîÑÎ†àÏûÑÎßàÎã§ Ï∫îÎ≤ÑÏä§Î•º ÏôÑÏ†ÑÌûà ÏßÄÏõÄ
         */
        function clearCanvas() {
            ctx.clearRect(0, 0, CONFIG.canvas.width, CONFIG.canvas.height);
        }

        /**
         * ==================== Ï∫êÎ¶≠ÌÑ∞ Î™∏Ï≤¥ Í∑∏Î¶¨Í∏∞ ====================
         * Ï∞πÏåÄÎñ°(Î™®Ï∞å) Ïä§ÌÉÄÏùºÏùò Î∂ÄÎìúÎü¨Ïö¥ ÏõêÌòï Ï∫êÎ¶≠ÌÑ∞
         * @param {number} cx - Ï§ëÏã¨ X Ï¢åÌëú
         * @param {number} cy - Ï§ëÏã¨ Y Ï¢åÌëú
         * @param {number} radius - Î∞òÏßÄÎ¶Ñ
         * @param {number} scaleY - YÏ∂ï Ïä§ÏºÄÏùº
         * @param {number} squish - Ï∞åÍ∑∏Îü¨Ïßê Ï†ïÎèÑ
         */
        function drawCharacterBody(cx, cy, radius, scaleY, squish) {
            const rx = radius * squish;              // XÏ∂ï Î∞òÏßÄÎ¶Ñ
            const ry = radius * scaleY;              // YÏ∂ï Î∞òÏßÄÎ¶Ñ
            
            // Î≤†ÏßÄÏñ¥ Í≥°ÏÑ†ÏùÑ ÏúÑÌïú Ï†úÏñ¥Ï†ê Í≥ÑÏÇ∞
            const k = 0.552284749831;               // ÏõêÏùÑ Î≤†ÏßÄÏñ¥Î°ú Í∑ºÏÇ¨ÌïòÎäî ÏÉÅÏàò
            const ox = rx * k;
            const oy = ry * k;

            // Í∑∏Î¶ºÏûê Ìö®Í≥º
            ctx.shadowColor = 'rgba(0, 0, 0, 0.15)';
            ctx.shadowBlur = 15;
            ctx.shadowOffsetY = 8;

            // Î™∏Ï≤¥ Í∑∏Î¶¨Í∏∞
            ctx.fillStyle = CONFIG.character.color;
            ctx.strokeStyle = CONFIG.character.strokeColor;
            ctx.lineWidth = 3;

            ctx.beginPath();
            
            // ÏÉÅÎã® (12Ïãú Î∞©Ìñ•)
            ctx.moveTo(cx, cy - ry);
            
            // Ïò§Î•∏Ï™Ω ÏÉÅÎã® Í≥°ÏÑ† (12Ïãú ‚Üí 3Ïãú)
            ctx.bezierCurveTo(
                cx + ox, cy - ry,
                cx + rx, cy - oy,
                cx + rx, cy
            );
            
            // Ïò§Î•∏Ï™Ω ÌïòÎã® Í≥°ÏÑ† (3Ïãú ‚Üí 6Ïãú)
            ctx.bezierCurveTo(
                cx + rx, cy + oy,
                cx + ox, cy + ry,
                cx, cy + ry
            );
            
            // ÏôºÏ™Ω ÌïòÎã® Í≥°ÏÑ† (6Ïãú ‚Üí 9Ïãú)
            ctx.bezierCurveTo(
                cx - ox, cy + ry,
                cx - rx, cy + oy,
                cx - rx, cy
            );
            
            // ÏôºÏ™Ω ÏÉÅÎã® Í≥°ÏÑ† (9Ïãú ‚Üí 12Ïãú)
            ctx.bezierCurveTo(
                cx - rx, cy - oy,
                cx - ox, cy - ry,
                cx, cy - ry
            );

            ctx.closePath();
            ctx.fill();
            ctx.stroke();

            // Í∑∏Î¶ºÏûê Ï†úÍ±∞ (Îã§Ïùå Í∑∏Î¶¨Í∏∞Ïóê ÏòÅÌñ• Ïïà Ï£ºÍ≤å)
            ctx.shadowColor = 'transparent';
            ctx.shadowBlur = 0;
            ctx.shadowOffsetY = 0;
        }

        /**
         * ==================== Îàà Í∑∏Î¶¨Í∏∞ ====================
         * Í∑ÄÏó¨Ïö¥ ÎèôÍ∑∏ÎûÄ Îàà 2Í∞ú
         * @param {number} cx - Ï§ëÏã¨ X Ï¢åÌëú
         * @param {number} cy - Ï§ëÏã¨ Y Ï¢åÌëú
         * @param {number} offsetY - YÏ∂ï Ïò§ÌîÑÏÖã
         */
        function drawEyes(cx, cy, offsetY) {
            const eyeOffsetX = 25;                  // Îàà Í∞ÑÍ≤©
            const eyeOffsetY = -10 + offsetY;       // Îàà ÎÜíÏù¥ (Ïï†ÎãàÎ©îÏù¥ÏÖò Î∞òÏòÅ)
            const eyeRadius = 5;                    // Îàà ÌÅ¨Í∏∞

            ctx.fillStyle = CONFIG.character.eyeColor;
            
            // ÏôºÏ™Ω Îàà
            ctx.beginPath();
            ctx.arc(cx - eyeOffsetX, cy + eyeOffsetY, eyeRadius, 0, Math.PI * 2);
            ctx.fill();

            // Ïò§Î•∏Ï™Ω Îàà
            ctx.beginPath();
            ctx.arc(cx + eyeOffsetX, cy + eyeOffsetY, eyeRadius, 0, Math.PI * 2);
            ctx.fill();
        }

        /**
         * ==================== ÏûÖ Í∑∏Î¶¨Í∏∞ ====================
         * Î∂ÄÎìúÎü¨Ïö¥ ÎØ∏ÏÜå
         * @param {number} cx - Ï§ëÏã¨ X Ï¢åÌëú
         * @param {number} cy - Ï§ëÏã¨ Y Ï¢åÌëú
         * @param {number} offsetY - YÏ∂ï Ïò§ÌîÑÏÖã
         */
        function drawMouth(cx, cy, offsetY) {
            const mouthY = cy + 15 + offsetY;       // ÏûÖ ÏúÑÏπò
            const mouthWidth = 30;                  // ÏûÖ ÎÑàÎπÑ

            ctx.strokeStyle = '#333';
            ctx.lineWidth = 2.5;
            ctx.lineCap = 'round';

            ctx.beginPath();
            ctx.arc(cx, mouthY, mouthWidth * 0.5, 0.2 * Math.PI, 0.8 * Math.PI);
            ctx.stroke();
        }

        /**
         * ==================== Î≥ºÌÑ∞Ïπò Í∑∏Î¶¨Í∏∞ ====================
         * Í∑ÄÏó¨Ïö¥ ÌïëÌÅ¨ Î≥ºÌÑ∞Ïπò
         * @param {number} cx - Ï§ëÏã¨ X Ï¢åÌëú
         * @param {number} cy - Ï§ëÏã¨ Y Ï¢åÌëú
         * @param {number} offsetY - YÏ∂ï Ïò§ÌîÑÏÖã
         */
        function drawBlush(cx, cy, offsetY) {
            const blushOffsetX = 45;
            const blushOffsetY = 10 + offsetY;

            ctx.fillStyle = 'rgba(255, 200, 220, 0.6)';

            // ÏôºÏ™Ω Î≥º
            ctx.beginPath();
            ctx.ellipse(cx - blushOffsetX, cy + blushOffsetY, 12, 8, 0, 0, Math.PI * 2);
            ctx.fill();

            // Ïò§Î•∏Ï™Ω Î≥º
            ctx.beginPath();
            ctx.ellipse(cx + blushOffsetX, cy + blushOffsetY, 12, 8, 0, 0, Math.PI * 2);
            ctx.fill();
        }

        /**
         * ==================== ÏôÑÏÑ±Îêú Ï∫êÎ¶≠ÌÑ∞ Í∑∏Î¶¨Í∏∞ ====================
         * ÌòÑÏû¨ ÌîÑÎ†àÏûÑÏùò Ïï†ÎãàÎ©îÏù¥ÏÖò Îç∞Ïù¥ÌÑ∞Î•º Ï†ÅÏö©Ìï¥ÏÑú Ï∫êÎ¶≠ÌÑ∞ Î†åÎçîÎßÅ
         * @param {number} frameIndex - ÌòÑÏû¨ ÌîÑÎ†àÏûÑ Ïù∏Îç±Ïä§
         */
        function drawCharacter(frameIndex) {
            // ÌòÑÏû¨ ÌîÑÎ†àÏûÑÏùò Ïï†ÎãàÎ©îÏù¥ÏÖò Îç∞Ïù¥ÌÑ∞ Í∞ÄÏ†∏Ïò§Í∏∞
            const frameData = ANIMATION_FRAMES[frameIndex];
            
            // Ï∫êÎ¶≠ÌÑ∞ Ï§ëÏã¨ ÏúÑÏπò (YÏ∂ïÎßå ÏõÄÏßÅÏûÑ)
            const cx = CONFIG.canvas.centerX;
            const cy = CONFIG.canvas.centerY + frameData.offsetY;
            const radius = CONFIG.character.baseRadius;

            // Î™∏Ï≤¥ Í∑∏Î¶¨Í∏∞
            drawCharacterBody(cx, cy, radius, frameData.scaleY, frameData.squish);

            // ÏñºÍµ¥ ÏöîÏÜå Í∑∏Î¶¨Í∏∞
            drawEyes(cx, cy, frameData.offsetY);
            drawMouth(cx, cy, frameData.offsetY);
            drawBlush(cx, cy, frameData.offsetY);
        }

        /**
         * ==================== Ïï†ÎãàÎ©îÏù¥ÏÖò Î£®ÌîÑ ====================
         * requestAnimationFrameÏùÑ ÏÇ¨Ïö©Ìïú Î∂ÄÎìúÎü¨Ïö¥ Î†åÎçîÎßÅ
         * Delta TimeÏúºÎ°ú 8fps ÌîÑÎ†àÏûÑ Ï†ÑÌôò Ï†úÏñ¥
         * @param {number} currentTime - ÌòÑÏû¨ ÏãúÍ∞Ñ (Î∞ÄÎ¶¨Ï¥à)
         */
        function animate(currentTime) {
            // Delta Time Í≥ÑÏÇ∞ (Ïù¥Ï†Ñ ÌîÑÎ†àÏûÑÍ≥ºÏùò ÏãúÍ∞Ñ Ï∞®Ïù¥)
            const deltaTime = currentTime - lastFrameTime;
            
            // ÏãúÍ∞Ñ ÎàÑÏ†Å
            accumulatedTime += deltaTime;

            // ÌîÑÎ†àÏûÑ Ï†ÑÌôò ÏãúÏ†ê Ï≤¥ÌÅ¨ (125msÎßàÎã§)
            if (accumulatedTime >= CONFIG.animation.frameDuration) {
                // Îã§Ïùå ÌîÑÎ†àÏûÑÏúºÎ°ú Ï†ÑÌôò
                currentFrame = (currentFrame + 1) % CONFIG.animation.totalFrames;
                
                // ÎàÑÏ†Å ÏãúÍ∞Ñ Î¶¨ÏÖã (ÎÇ®ÏùÄ ÏãúÍ∞Ñ Ïú†ÏßÄ)
                accumulatedTime -= CONFIG.animation.frameDuration;
            }

            // Ï∫îÎ≤ÑÏä§ Ï¥àÍ∏∞Ìôî
            clearCanvas();

            // ÌòÑÏû¨ ÌîÑÎ†àÏûÑÏùò Ï∫êÎ¶≠ÌÑ∞ Í∑∏Î¶¨Í∏∞
            drawCharacter(currentFrame);

            // ÎßàÏßÄÎßâ ÌîÑÎ†àÏûÑ ÏãúÍ∞Ñ ÏóÖÎç∞Ïù¥Ìä∏
            lastFrameTime = currentTime;

            // Îã§Ïùå ÌîÑÎ†àÏûÑ ÏòàÏïΩ
            animationId = requestAnimationFrame(animate);
        }

        /**
         * ==================== Ïï†ÎãàÎ©îÏù¥ÏÖò ÏãúÏûë ====================
         * Ï¥àÍ∏∞Ìôî Î∞è Ïï†ÎãàÎ©îÏù¥ÏÖò Î£®ÌîÑ ÏãúÏûë
         */
        function startAnimation() {
            console.log('üé¨ Ïï†ÎãàÎ©îÏù¥ÏÖò ÏãúÏûë!');
            console.log(`‚öôÔ∏è ÏÑ§Ï†ï: ${CONFIG.animation.targetFPS}fps, ${CONFIG.animation.totalFrames}ÌîÑÎ†àÏûÑ`);
            
            // Ï¥àÍ∏∞ ÏãúÍ∞Ñ ÏÑ§Ï†ï
            lastFrameTime = performance.now();
            accumulatedTime = 0;
            currentFrame = 0;

            // Ï≤´ ÌîÑÎ†àÏûÑ Í∑∏Î¶¨Í∏∞
            clearCanvas();
            drawCharacter(currentFrame);

            // Ïï†ÎãàÎ©îÏù¥ÏÖò Î£®ÌîÑ ÏãúÏûë
            animationId = requestAnimationFrame(animate);
        }

        /**
         * ==================== Ïï†ÎãàÎ©îÏù¥ÏÖò Ï†ïÏßÄ ====================
         * ÎîîÎ≤ÑÍπÖÏù¥ÎÇò ÏùºÏãúÏ†ïÏßÄ Ïãú ÏÇ¨Ïö©
         */
        function stopAnimation() {
            if (animationId) {
                cancelAnimationFrame(animationId);
                animationId = null;
                console.log('‚è∏Ô∏è Ïï†ÎãàÎ©îÏù¥ÏÖò Ï†ïÏßÄ');
            }
        }

        // ==================== ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú ÏûêÎèô ÏãúÏûë ====================
        window.addEventListener('load', () => {
            console.log('‚úÖ ÌéòÏù¥ÏßÄ Î°úÎìú ÏôÑÎ£å');
            startAnimation();
        });

        // ==================== ÌéòÏù¥ÏßÄ Ïù¥ÌÉà Ïãú Ï†ïÎ¶¨ ====================
        window.addEventListener('beforeunload', () => {
            stopAnimation();
        });

        // ==================== ÎîîÎ≤ÑÍπÖÏö©: Ï†ÑÏó≠ Ìï®ÏàòÎ°ú ÎÖ∏Ï∂ú ====================
        window.characterAnimation = {
            start: startAnimation,
            stop: stopAnimation,
            getCurrentFrame: () => currentFrame,
            getFrameData: () => ANIMATION_FRAMES[currentFrame]
        };

    </script>
</body>
</html>


